{% extends "base.html" %}
{% block css %}
	<style type="text/css">
	  html { height: 100% }
	  body { height: 100%; margin: 0px; padding: 0 }
	  #map_canvas { height: 100%;margin-top:40px;}
	</style>
{% endblock %}
{% block script %}
	<script type="text/javascript"
	  src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD8UCCAp_euR_73sVdSJw3gaMuFR7Ruqgs&sensor=false">
	</script>
	<script type="text/javascript">
		var myCenter = new google.maps.LatLng(30.3045022222222,120.08633333333);
		var icon_base = "http://google-maps-icons.googlecode.com/files/";
		var map;
		var markers = new Array();
		var infowins = new Array();
	  	function initialize() {
		  	var opt = { minZoom: 15, maxZoom: 18 };
			var mapOptions = {
			  center: myCenter,
			  zoom: 16,
			  mapTypeId: google.maps.MapTypeId.ROADMAP
			};
			map = new google.maps.Map(document.getElementById("map_canvas"),
				mapOptions);
			map.setOptions(opt);
			
			var lat = new Array();
			var lng = new Array();
			var position = new Array();
			var myicon = new Array();
			var content = new Array();
			var count = 1;
			{% for place in places %}
				count++;
			 	lat[{{forloop.counter}}] = {{place.latitude}};
			 	lng[{{forloop.counter}}] = {{place.longitude}};
			 	myicon[{{forloop.counter}}] = '{{place.place_type.icon.name}}';
			 	content[{{forloop.counter}}] = "<h4>{{place.name}}</h4><p>{{place.description}}</p>";
			{% endfor %}
			for(i = 1; i <= count ; i++)
			{
				position[i] = new google.maps.LatLng(lat[i],lng[i])
				markers[i] = new google.maps.Marker({
				 		position: position[i],
				 		map: map,
				 		icon: icon_base + myicon[i],
				 		title: 'My Location'
				 	});
				//infowins[i] = new google.maps.InfoWindow({
				//			content: content[i]
				// 	  	});
				//infowins[i].open(map,markers[i]);	  	
				//google.maps.event.addListener(markers[i], 'click', function() {
				//	infowins[i].open(map, markers[i]);
				//});
			}
			
			

	 	}

		google.maps.event.addDomListener(window, 'load', initialize);
	</script>
{% endblock %}
{% block main %}
	<div id="map_canvas"></div>
{% endblock %}
